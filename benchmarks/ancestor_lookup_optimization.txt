BEFORE

$ ruby ancestor_lookup_optimization.rb 
 6.250000   0.900000   7.150000 (  7.205515)
12.140000   0.930000  13.070000 ( 13.347171)
18.320000   0.980000  19.300000 ( 19.369462)
23.770000   0.950000  24.720000 ( 24.840441)
 
AFTER

$ ruby ancestor_lookup_optimization.rb 
 5.830000   0.910000   6.740000 (  6.764342)
10.620000   0.900000  11.520000 ( 11.559299)
15.710000   0.980000  16.690000 ( 16.779409)
19.950000   0.940000  20.890000 ( 20.951185)